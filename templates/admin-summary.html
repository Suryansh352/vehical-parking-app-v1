<!DOCTYPE html>
<html lang="en">
<head>
    <title>Admin Summary</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>
<div class="container mt-4">
    <h2>Admin Summary</h2>
    <ul>
        <li>Total Parking Lots: {{ total_lots }}</li>
        <li>Total Parking Spots: {{ total_spots }}</li>
        <li>Available Spots: {{ available_spots }}</li>
        <li>Occupied Spots: {{ occupied_spots }}</li>
        <li>Total Registered Users: {{ total_users }}</li>
    </ul>
    <h3>Parking Lots Utilization</h3>
{% if plot_data %}
    <img src="data:image/png;base64,{{ plot_data }}" alt="Parking Lots Utilization Chart" class="img-fluid mb-4">
{% endif %}


    <h3>Parking Lots Detail</h3>
    <table class="table">
        <thead>
            <tr><th>Lot Name</th><th>Total Spots</th><th>Available</th><th>Occupied</th></tr>
        </thead>
        <tbody>
            {% for lot in lots_info %}
            <tr>
                <td>{{ lot.name }}</td>
                <td>{{ lot.total_spots }}</td>
                <td>{{ lot.available_spots }}</td>
                <td>{{ lot.occupied_spots }}</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>

    <h3>Recent Reservations</h3>
    <table class="table">
        <thead>
            <tr><th>User</th><th>Spot ID</th><th>Lot Name</th><th>Parked At</th><th>Left At</th></tr>
        </thead>
        <tbody>
            {% for r in recent_reservations %}
            <tr>
                <td>{{ r.user.email }}</td>
                <td>{{ r.spot_id }}</td>
                <td>{{ r.spot.lot.prime_location_name }}</td>
                <td>{{ r.parking_timestamp.strftime('%Y-%m-%d %H:%M') }}</td>
                <td>{% if r.leaving_timestamp %}{{ r.leaving_timestamp.strftime('%Y-%m-%d %H:%M') }}{% else %}Currently Parked{% endif %}</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>

    <a href="{{ url_for('admin_dashboard') }}" class="btn btn-secondary">Back to Dashboard</a>
</div>
</body>
</html>
